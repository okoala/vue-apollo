/*!
 * Vue-Apollo v1.0.3
 * (c) 2016 Koala Huang
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("apollo-client"),require("lodash.merge"),require("graphql-tag")):"function"==typeof define&&define.amd?define(["apollo-client","lodash.merge","graphql-tag"],t):t(e.apolloClient,e.merge,e.gql)}(this,function(e,t,r){"use strict";function n(e){e.mixin({created:function(){this._apolloSubscriptions=[],this.$apollo=new p(this);var e=this.$options.apollo;if(e){if(e.data)for(var t in e.data)this.$apollo.option(t,e.data[t],!1);if(e.watch)for(var r in e.watch)this.$apollo.option(r,e.watch[r],!0)}},destroyed:function(){this.$apollo=null,this._apolloSubscriptions.forEach(function(e){return e.unsubscribe()}),this._apolloSubscriptions=[]}})}function o(e){return h?void console.error("[vue-apollo] already installed. Vue.use(VueApollo) should be called only once."):(h=e,void n(h))}var i=e.default;t="default"in t?t.default:t,r="default"in r?r.default:r;var a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();global?global.gql=r:window&&(window.gql=r);var u={},c=null,s=function(){function e(){a(this,e)}return l(e,null,[{key:"setOptions",value:function(e){t(u,e),c&&console.warn("Options set after the apollo client has been created will not be applied.")}},{key:"createClient",value:function(){return c=new i(u)}},{key:"client",set:function(e){c=e},get:function(){return c||e.createClient(),c}}]),e}(),f=Object.freeze({VueApolloClient:s}),p=function(){function e(t){a(this,e),this.vm=t,this.querySubscriptions={}}return l(e,[{key:"watchQuery",value:function(e){var t=this.vm,r=this.client.watchQuery(e);return{observable:r,subscribe:function(e){var n=r.subscribe(e);return t._apolloSubscriptions.push(n),n}}}},{key:"option",value:function(e,t,r){function n(e){var t=e.data;i(t)}function o(e){u(e)}function i(r){l(),"function"==typeof t.update?s.$set(s,e,t.update.call(s,r)):void 0===r[e]?console.error("Missing "+e+" attribute on result",r):s.$set(s,e,r[e]),"function"==typeof t.result&&t.result.call(s,r)}function a(e){g&&s.$set(g,s.$get(g)+e),w&&w(1===e,e)}function l(){m||(a(-1),m=!0)}function u(e){if(l(),e.graphQLErrors&&0!==e.graphQLErrors.length){console.error("GraphQL execution errors for query "+p);var r=!0,n=!1,o=void 0;try{for(var i,a=e.graphQLErrors[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var u=i.value;console.error(u)}}catch(e){n=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw o}}}else e.networkError?console.error("Error sending the query "+p,e.networkError):console.error(e);"function"==typeof t.error&&t.error(e)}function c(t){a(1),r?(d&&d.unsubscribe(),f.querySubscriptions[e]=d=f.watchQuery({query:p,variables:t,forceFetch:h,pollInterval:y,returnPartialData:b,fragments:v}).subscribe({next:n,error:o})):f.query({query:p,variables:t,forceFetch:h,fragments:v}).then(n).catch(o)}var s=this.vm,f=this,p=void 0,d=void 0,h=t.forceFetch,y=t.pollInterval,b=t.returnPartialData,v=t.fragments,g=t.loadingKey,w=t.loadingChangeCb;"function"==typeof w&&(w=w.bind(s));var m=!1;p=t.query?t.query:t,"function"==typeof t.variables?s.$watch(t.variables.bind(s),c,{immediate:!0}):c(t.variables)}},{key:"client",get:function(){return s.client}},{key:"query",get:function(){return this.client.query}},{key:"mutate",get:function(){return this.client.mutate}}]),e}(),d=Object.freeze({DollarApollo:p}),h=void 0;"undefined"!=typeof window&&window.Vue&&o(window.Vue),module.exports=Object.assign({install:o},e,d,f)});