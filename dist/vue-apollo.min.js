/*!
 * Vue-Apollo v1.0.2
 * (c) 2016 Koala Huang
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("apollo-client"),require("lodash"),require("graphql-tag")):"function"==typeof define&&define.amd?define(["apollo-client","lodash","graphql-tag"],t):t(e.apolloClient,e._,e.gql)}(this,function(e,t,n){"use strict";function r(e){e.mixin({created:function(){this._apolloSubscriptions=[],this.$apollo=new p(this);var e=this.$options.apollo;if(e){if(e.data)for(var t in e.data)this.$apollo.option(t,e.data[t],!1);if(e.watch)for(var n in e.watch)this.$apollo.option(n,e.watch[n],!0)}},destroyed:function(){this.$apollo=null,this._apolloSubscriptions.forEach(function(e){return e.unsubscribe()}),this._apolloSubscriptions=[]}})}function o(e){return h?void console.error("[vue-apollo] already installed. Vue.use(VueApollo) should be called only once."):(h=e,void r(h))}var i=e.default;t="default"in t?t.default:t,n="default"in n?n.default:n;var a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();global?global.gql=n:window&&(window.gql=n);var u={},c=null,s=function(){function e(){a(this,e)}return l(e,null,[{key:"setOptions",value:function(e){t.merge(u,e),c&&console.warn("Options set after the apollo client has been created will not be applied.")}},{key:"createClient",value:function(){return c=new i(u)}},{key:"client",set:function(e){c=e},get:function(){return c||e.createClient(),c}}]),e}(),f=Object.freeze({VueApolloClient:s}),p=function(){function e(t){a(this,e),this.vm=t,this.querySubscriptions={}}return l(e,[{key:"watchQuery",value:function(e){var t=this.vm,n=this.client.watchQuery(e);return{observable:n,subscribe:function(e){var r=n.subscribe(e);return t._apolloSubscriptions.push(r),r}}}},{key:"option",value:function(e,t,n){function r(e){var t=e.data;i(t)}function o(e){u(e)}function i(n){l(),"function"==typeof t.update?s.$set(s,e,t.update.call(s,n)):void 0===n[e]?console.error("Missing "+e+" attribute on result",n):s.$set(s,e,n[e]),"function"==typeof t.result&&t.result.call(s,n)}function a(e){g&&s.$set(g,s.$get(g)+e),w&&w(1===e,e)}function l(){q||(a(-1),q=!0)}function u(e){if(l(),e.graphQLErrors&&0!==e.graphQLErrors.length){console.error("GraphQL execution errors for query "+p);var n=!0,r=!1,o=void 0;try{for(var i,a=e.graphQLErrors[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;console.error(u)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}else e.networkError?console.error("Error sending the query "+p,e.networkError):console.error(e);"function"==typeof t.error&&t.error(e)}function c(t){a(1),n?(d&&d.unsubscribe(),f.querySubscriptions[e]=d=f.watchQuery({query:p,variables:t,forceFetch:h,pollInterval:y,returnPartialData:b,fragments:v}).subscribe({next:r,error:o})):f.query({query:p,variables:t,forceFetch:h,fragments:v}).then(r).catch(o)}var s=this.vm,f=this,p=void 0,d=void 0,h=t.forceFetch,y=t.pollInterval,b=t.returnPartialData,v=t.fragments,g=t.loadingKey,w=t.loadingChangeCb;"function"==typeof w&&(w=w.bind(s));var q=!1;p=t.query?t.query:t,"function"==typeof t.variables?s.$watch(t.variables.bind(s),c,{immediate:!0}):c(t.variables)}},{key:"client",get:function(){return s.client}},{key:"query",get:function(){return this.client.query}},{key:"mutate",get:function(){return this.client.mutate}}]),e}(),d=Object.freeze({DollarApollo:p}),h=void 0;"undefined"!=typeof window&&window.Vue&&o(window.Vue),module.exports=Object.assign({install:o},e,d,f)});